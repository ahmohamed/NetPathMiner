<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Assigning weights to network edges — assignEdgeWeights • NetPathMiner</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Assigning weights to network edges — assignEdgeWeights"><meta property="og:description" content="This function computes edge weights based on a gene expression profile."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NetPathMiner</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.41.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/NPMVignette.html">Workflow for NetPathMiner</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ahmohamed/NetPathMiner/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Assigning weights to network edges</h1>
    <small class="dont-index">Source: <a href="https://github.com/ahmohamed/NetPathMiner/blob/master/R/netWeight.R" class="external-link"><code>R/netWeight.R</code></a></small>
    <div class="hidden name"><code>assignEdgeWeights.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function computes edge weights based on a gene expression profile.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">assignEdgeWeights</span><span class="op">(</span></span>
<span>  <span class="va">microarray</span>,</span>
<span>  <span class="va">graph</span>,</span>
<span>  <span class="va">use.attr</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  weight.method <span class="op">=</span> <span class="st">"cor"</span>,</span>
<span>  complex.method <span class="op">=</span> <span class="st">"max"</span>,</span>
<span>  missing.method <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>  same.gene.penalty <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-microarray">microarray<a class="anchor" aria-label="anchor" href="#arg-microarray"></a></dt>
<dd><p>Microarray should be a Dataframe or a matrix, with genes as rownames, and samples as columns.</p></dd>


<dt id="arg-graph">graph<a class="anchor" aria-label="anchor" href="#arg-graph"></a></dt>
<dd><p>An annotated igraph object.</p></dd>


<dt id="arg-use-attr">use.attr<a class="anchor" aria-label="anchor" href="#arg-use-attr"></a></dt>
<dd><p>An attribute name to map <code>microarray</code> rows (genes) to graph vertices. The attribute must
be annotated in <code>graph</code>, and the values correspond to <code>rownames</code> of <code>microarray</code>. You can check the coverage and
if there are complex vertices using <code><a href="getAttr.html">getAttrStatus</a></code>. You can eliminate complexes using <code><a href="makeGeneNetwork.html">expandComplexes</a></code>.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Sample labels, given as a factor or a character vector. This must be the same size as the columns of <code>microarray</code></p></dd>


<dt id="arg-weight-method">weight.method<a class="anchor" aria-label="anchor" href="#arg-weight-method"></a></dt>
<dd><p>A function, or a string indicating the name of the function to be used to compute the edge weights.
The function is provided with 2 numerical verctors (2 rows from <code>microarray</code>), and it should return a single numerical
value (or <code>NA</code>). The default computes Pearson's correlation.</p></dd>


<dt id="arg-complex-method">complex.method<a class="anchor" aria-label="anchor" href="#arg-complex-method"></a></dt>
<dd><p>A function, or a string indicating the name of the function to be used in weighting edges connecting complexes.
If a vertex has &gt;1 attribute value, all possible pairwise weights are first computed, and given to <code>complex.method</code>. The default
function is <code>max</code>.</p></dd>


<dt id="arg-missing-method">missing.method<a class="anchor" aria-label="anchor" href="#arg-missing-method"></a></dt>
<dd><p>A function, or a string indicating the name of the function to be used in weighting edges when one of the vertices
lack expression data. The function is passed all edge weights on the graph. Default is <code><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></code>.</p></dd>


<dt id="arg-same-gene-penalty">same.gene.penalty<a class="anchor" aria-label="anchor" href="#arg-same-gene-penalty"></a></dt>
<dd><p>A numerical value to be assigned when 2 adjacent vertices have the same attribute value, since correlation and
similarity measure will give perfect scores. Alternatively, <code>same.gene.penalty</code> can be a function, computing the penalty from all
edge weights on the graph (excluding same-gene and missing values). The default is to take the <code><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></code></p></dd>


<dt id="arg-bootstrap">bootstrap<a class="anchor" aria-label="anchor" href="#arg-bootstrap"></a></dt>
<dd><p>An integer <code>n</code>, where the <code>weight.method</code> is perfomed on <code>n</code> permutations of the gene profiles, and taking
the median value. Set it to <code>NA</code> to disable bootstrapping.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Print the progress of the function.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The input graph with <code>edge.weight</code> as an edge attribute. The attribute can be a list of weights if <code>y</code> labels
were provided.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Ahmed Mohamed</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co">## Convert a metabolic network to a reaction network.</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ex_sbml</span><span class="op">)</span> <span class="co"># bipartite metabolic network of Carbohydrate metabolism.</span></span></span>
<span class="r-in"><span> <span class="va">rgraph</span> <span class="op">&lt;-</span> <span class="fu"><a href="makeReactionNetwork.html">makeReactionNetwork</a></span><span class="op">(</span><span class="va">ex_sbml</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This graph was created by an old(er) igraph version.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Call `igraph::upgrade_graph()` on it to use with the current igraph version.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> For now we convert it on the fly...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## Assign edge weights based on Affymetrix attributes and microarray dataset.</span></span></span>
<span class="r-in"><span> <span class="co"># Calculate Pearson's correlation.</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ex_microarray</span><span class="op">)</span>  <span class="co"># Part of ALL dataset.</span></span></span>
<span class="r-in"><span>  <span class="va">rgraph</span> <span class="op">&lt;-</span> <span class="fu">assignEdgeWeights</span><span class="op">(</span>microarray <span class="op">=</span> <span class="va">ex_microarray</span>, graph <span class="op">=</span> <span class="va">rgraph</span>,</span></span>
<span class="r-in"><span>    weight.method <span class="op">=</span> <span class="st">"cor"</span>, use.attr<span class="op">=</span><span class="st">"miriam.uniprot"</span>,</span></span>
<span class="r-in"><span>    y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">ex_microarray</span><span class="op">)</span><span class="op">)</span>, bootstrap <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 genes were present in the microarray, but not represented in the network.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55 genes were couldn't be found in microarray.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assigning edge weights for label ALL1/AF4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assigning edge weights for label BCR/ABL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assigning edge weights for label E2A/PBX1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assigning edge weights for label NEG </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Using Spearman correlation, assigning missing edges to -1</span></span></span>
<span class="r-in"><span> <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>   <span class="fu">assignEdgeWeights</span><span class="op">(</span><span class="va">microarray</span>, <span class="va">graph</span>, use.attr<span class="op">=</span><span class="st">"miriam.affy.probeset"</span>,</span></span>
<span class="r-in"><span>       y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">microarray</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       weight.method <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span>, method<span class="op">=</span><span class="st">"spearman"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       missing.method <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ahmed Mohamed, Tim Hancock, Tim Hancock.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

